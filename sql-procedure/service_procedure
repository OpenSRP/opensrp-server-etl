-- Procedure for generating misreport
   CREATE OR REPLACE FUNCTION generate_mis_report(division VARCHAR(70), district VARCHAR(70)
                                                , upazilla VARCHAR(70), unionname VARCHAR(70)
                                                , ward VARCHAR(70), unit VARCHAR(70)
                                                , currentM VARCHAR(70), currentY VARCHAR(70)
                                                , provider VARCHAR(70))
   RETURNS integer AS $$
    declare
    /*Family Planning Report Variables*/
    fpOldPillUsage integer := 0;
    fpNewPillUsage integer := 0;
    fpCurrentTotalPillUsages integer := 0;
    fpPrevTotalPillUsages integer := 0;
    fpTotalPillUsages integer := 0;
    fpLeftPillAndStartedNone integer := 0;
    fpLeftPillAndStartedOther integer := 0;
    
    fpOldCondomUsage integer := 0;
    fpNewCondomUsage integer := 0;
    fpCurrentTotalCondomUsages integer := 0;
    fpPrevTotalCondomUsages integer := 0;
    fpTotalCondomUsages integer := 0;
    fpLeftCondomAndStartedNone integer := 0;
    fpLeftCondomAndStartedOther integer := 0;
    
    fpOldInjectableUsage integer := 0;
    fpNewInjectableUsage integer := 0;
    fpCurrentTotalInjectableUsages integer := 0;
    fpPrevTotalInjectableUsages integer := 0;
    fpTotalInjectableUsages integer := 0;
    fpLeftInjectableAndStartedNone integer := 0;
    fpLeftInjectableAndStartedOther integer := 0;
    
    fpOldIUDUsage integer := 0;
    fpNewIUDUsage integer := 0;
    fpCurrentTotalIUDUsages integer := 0;
    fpPrevTotalIUDUsages integer := 0;
    fpTotalIUDUsages integer := 0;
    fpLeftIUDAndStartedNone integer := 0;
    fpLeftIUDAndStartedOther integer := 0;
  
    fpOldImplantUsage integer := 0;
    fpNewImplantUsage integer := 0;
    fpCurrentTotalImplantUsages integer := 0;
    fpPrevTotalImplantUsages integer := 0;
    fpTotalImplantUsages integer := 0;
    fpLeftImplantAndStartedNone integer := 0;
    fpLeftImplantAndStartedOther integer := 0;
  
    fpOldMalePermanentUsage integer := 0;
    fpNewMalePermanentUsage integer := 0;
    fpCurrentTotalMalePermanentUsages integer := 0;
    fpPrevTotalMalePermanentUsages integer := 0;
    fpTotalMalePermanentUsages integer := 0;
  
    fpOldFemalePermanentUsage integer := 0;
    fpNewFemalePermanentUsage integer := 0;
    fpCurrentTotalFemalePermanentUsages integer := 0;
    fpPrevTotalFemalePermanentUsages integer := 0;
    fpTotalFemalePermanentUsages integer := 0;
  
    fpCurrentEligibleCoupleCount integer := 0;
    fpPrevEligibleCoupleCount integer := 0;
    fpTotalEligibleCoupleCount integer := 0;
    fpNewEligibleCoupleCount integer := 0;
    
    fpTotalOldUsages integer := 0;
    fpTotalNewUsages integer := 0;
    fpTotalCurrentUsages integer := 0;
    fpTotalPrevUsages integer := 0;
    fpTotalUsages integer := 0;
    fpTotalStartedNone integer := 0;
    fpTotalStartedOther integer := 0;

    fpCAR int := 0;

    /*Maternity Care Report Variables*/
    mcCurrentNewPregnantCount integer := 0;
    mcCurrentOldPregnantCount integer := 0;
    mcCurrentTotalPregnantCount integer := 0;

    mcPrevPregnantCount integer := 0;
    mcTotalPregnantCount integer := 0;

    mcANCVisit1Info integer := 0;
    mcANCVisit2Info integer := 0;
    mcANCVisit3Info integer := 0;
    mcANCVisit4Info integer := 0;

    mcANCVisit1Service integer := 0;
    mcANCVisit2Service integer := 0;
    mcANCVisit3Service integer := 0;
    mcANCVisit4Service integer := 0;

    mcBirthAtHomeWithTrainedPerson integer := 0;
    mcBirthAtHomeWithUntrainedPerson integer := 0;
    mcNormalBirthAtHospitalOrClinic integer := 0;
    mcCesareanBirthAtHospitalOrClinic integer := 0;

    mcIsDelivered integer := 0;
    mcAMTSL integer := 0;
    mcNoOxytocinAndMisoprostolgiven integer := 0;

    mcMotherPNCVisit1Info integer := 0;
    mcMotherPNCVisit2Info integer := 0;
    mcMotherPNCVisit3Info integer := 0;
    mcMotherPNCVisit4Info integer := 0;

    mcMotherPNCVisit1Service integer := 0;
    mcMotherPNCVisit2Service integer := 0;
    mcMotherPNCVisit3Service integer := 0;
    mcMotherPNCVisit4Service integer := 0;

    mcPNCCounselling integer := 0;

    mcChildPNCVisit1Info integer := 0;
    mcChildPNCVisit2Info integer := 0;
    mcChildPNCVisit3Info integer := 0;
    mcChildPNCVisit4Info integer := 0;

    mcChildPNCVisit1Service integer := 0;
    mcChildPNCVisit2Service integer := 0;
    mcChildPNCVisit3Service integer := 0;
    mcChildPNCVisit4Service integer := 0;

    mcReferredComplexPregnant integer := 0;
    mcReferredTotalComplexityCount integer := 0;
    mcReferredMgSO4Count integer := 0;
    mcReferredChildComplexityCount integer := 0;

    mcTTDoseOne integer := 0;
    mcTTDoseTwo integer := 0;
    mcTTDoseThree integer := 0;
    mcTTDoseFour integer := 0;
    mcTTDoseFive integer := 0;

    mcECPReceivedCount integer := 0;
    mcMisoprostolReceivedCount integer := 0;

    mcAdvisedIncompatibleCouple integer := 0;
    mcReferredIncompatibleCouple integer := 0;

    mcCounsellingOnChangesOfAdolescent integer := 0;
    mcCounsellingBadEffectOnChildMarriageAndTeenPregnancy integer := 0;
    mcCounsellingTeenagersOnTakingIronAndFolicAcid integer := 0;
    mcCounsellingOnInfectionOfDiseases integer := 0;

    mcSatelliteClinicPresence integer := 0;
    mcEPISessionPresence integer := 0;
    mcCommunityClinicPresence integer := 0;

    /*Child Care Report Variables*/
    ccIsCleanedInfo integer := 0;
    ccIsCleanedService integer := 0;
    ccUsedChlorhexidinInfo integer := 0;
    ccUsedChlorhexidinService integer := 0;

    ccFedBreastMilkCount integer := 0;
    ccUsedMaskCount integer := 0;

    ccBcgCount integer := 0;
    ccOpv1Andpcv1Andpenta1Count integer := 0;
    ccOpv2Andpcv2Andpenta2Count integer := 0;
    ccOpv3Andpenta3Count integer := 0;
    ccPcv3Count integer := 0;
    ccMrAndopv4Count integer := 0;
    ccMeaslesCount integer := 0;

    ccReferredChildOfDangerousDiseasesInfo integer := 0;
    ccReferredChildOfDangerousDiseasesService integer := 0;
    ccReferredChildOfPneumoniaInfo integer := 0;
    ccReferredChildOfPneumoniaService integer := 0;
    ccReferredChildOfDiarrheaInfo integer := 0;
    ccReferredChildOfDiarrheaService integer := 0;

    /*Birth And Death Report Variables*/
    bdTotalLiveBirth integer := 0;
    bdtotalChildWithUnderWeight integer := 0;
    bdTotalPrematureChild integer := 0;
    bdStillBirthCount integer := 0;

    bdDeathLessThan7Days integer := 0;
    bdDeathLessThan28Days integer := 0;
    bdDeathLessThan1Yr integer := 0;
    bdTotalDeathLessThan1Yr integer := 0;

    bdDeathLessThan5Yr integer := 0;
    bdDeathOfMother integer := 0;
    bdDeathOfOther integer := 0;
    bdTotalDeathCount integer := 0;

    /*Woman Nutrition Report Variables*/
    wnCounsellingIronForPregWoman integer := 0;
    wnCounsellingIronForMother integer := 0;
    wnDistributionIronForPregWoman integer := 0;
    wnDistributionIronForMother integer := 0;
    wnCounsellingOnBreastMilkForPregWoman integer := 0;
    wnCounsellingOnBreastMilkForMother integer := 0;

    wnCounsellingOnFeedingMNP integer := 0;

    /*Child Nutrition Report Variables*/
    cnBreastFeedingWithin1Hour integer := 0;
    cnBreastFeedingUntill6Month integer := 0;
    cnComplementaryFoodForChild6TO23 integer := 0;
    cnComplementaryFoodForChild24to59 integer := 0;
    cnReceivedMNP integer := 0;

    cnContractedMAMChildZeroToSix integer := 0;
    cnContractedMAMChild6TO23 integer := 0;
    cnContractedMAMChild24to59 integer := 0;

    cnContractedSAMChildZeroToSix integer := 0;
    cnContractedSAMChild6TO23 integer := 0;
    cnContractedSAMChild24to59 integer := 0;

    /*Utility variables*/
    recordExists integer := 0;
    prevRecordCount integer := 0;
    currentMonth integer := currentM :: integer;
    currentYear integer := currentY :: integer;
    prevMonth integer := currentMonth - 1;
    prevYear integer := currentYear;

    child6Month interval :='6 months';
    child24Months interval :='2 years';
    child60Months interval :='5 years';

    current_mis1report_seq_id integer := 0;

   BEGIN
        select count(*) from mis1report m1 into recordExists
        where m1.reporting_division=division
        and m1.reporting_district=district
        and m1.reporting_upazilla=upazilla
        and m1.reporting_ward=ward
        and m1.reporting_union=unionname
        and m1.reporting_unit=unit
        and m1.reporting_month=currentM
        and m1.reporting_year=currentY
        and m1.reporting_provider=provider;

        IF recordExists = 0 THEN

            /*Calculating previous month*/
            IF currentMonth = 1 THEN
                prevMonth := 12;
                prevYear := currentYear - 1;
            END IF;

            /*Calculating previous psrf record exist or not*/
	    SELECT count(distinct p1.relationalid) INTO prevRecordCount FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (EXTRACT(MONTH FROM p1.today) = prevMonth
                    AND EXTRACT(YEAR FROM p1.today) = prevYear)
            and member.mem_division=division
            and member.mem_district=district
            and member.mem_upazilla=upazilla
            and member.mem_ward=ward
            and member.mem_union=unionname
            and member.mem_subunit=unit;


            /*Family Planning Report Queries*/

            /*Pill Usage queries*/
            SELECT COUNT(distinct p1.relationalid) INTO fpOldPillUsage FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            JOIN psrf p2 ON (p1.relationalid= p2.relationalid)
            WHERE (p1.birth_control=1 
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND (p2.birth_control=1
                   AND EXTRACT(MONTH FROM p2.today)=prevMonth
                   AND EXTRACT(YEAR FROM p2.today)=prevYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;
            
            IF prevRecordCount = 0 THEN
		SELECT COUNT(distinct p1.relationalid) INTO fpNewPillUsage FROM psrf p1
                JOIN member ON (p1.relationalid= member.caseid)
                JOIN psrf p2 ON (p1.relationalid= p2.relationalid)
                WHERE (p1.birth_control=1 
                        AND EXTRACT(MONTH FROM p1.today)=currentMonth
                        AND EXTRACT(YEAR FROM p1.today)=currentYear)
                AND member.mem_district=district
                AND member.mem_division=division
                AND member.mem_upazilla=upazilla
                AND member.mem_ward=ward
                AND member.mem_union=unionname
                AND member.mem_subunit=unit;          
            ELSE   
                SELECT COUNT(distinct p1.relationalid) INTO fpNewPillUsage FROM psrf p1
                JOIN member ON (p1.relationalid= member.caseid)
                JOIN psrf p2 ON (p1.relationalid= p2.relationalid)
                WHERE ( p1.birth_control=1 
                        AND EXTRACT(MONTH FROM p1.today)=currentMonth
                        AND EXTRACT(YEAR FROM p1.today)=currentYear)
                AND (not p2.birth_control=1
                        AND EXTRACT(MONTH FROM p2.today)=prevMonth
                        AND EXTRACT(YEAR FROM p2.today)=prevYear)
                AND member.mem_district=district
                AND member.mem_division=division
                AND member.mem_upazilla=upazilla
                AND member.mem_ward=ward
                AND member.mem_union=unionname
                AND member.mem_subunit=unit;
            END IF;

            SELECT COUNT(distinct p1.relationalid) INTO fpCurrentTotalPillUsages FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE ( p1.birth_control=1 
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO fpPrevTotalPillUsages FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE ( p1.birth_control=1 
                    AND EXTRACT(MONTH FROM p1.today)=prevMonth
                    AND EXTRACT(YEAR FROM p1.today)=prevYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO fpTotalPillUsages FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE ( p1.birth_control=1 
                    AND EXTRACT(MONTH FROM p1.today) <= currentMonth
                    AND EXTRACT(YEAR FROM p1.today) <= currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO fpLeftPillAndStartedNone FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            JOIN psrf p2 ON (p1.relationalid= p2.relationalid)
            WHERE ( p1.using_fp = 0
                   AND p1.birth_control = 99
                   AND EXTRACT(MONTH FROM p1.today)=currentMonth
                   AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND (p2.birth_control=1
                 AND EXTRACT(MONTH FROM p2.today)=prevMonth
                 AND EXTRACT(YEAR FROM p2.today)=prevYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO fpLeftPillAndStartedOther FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            JOIN psrf p2 ON (p1.relationalid= p2.relationalid)
            WHERE (p1.birth_control IN (2,3,4,5,6)
                   AND EXTRACT(MONTH FROM p1.today)=currentMonth
                   AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND (p2.birth_control=1 
                 AND EXTRACT(MONTH FROM p2.today)=prevMonth
                 AND EXTRACT(YEAR FROM p2.today)=prevYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;


           /*Condom Usage queries*/
            SELECT COUNT(distinct p1.relationalid) INTO fpOldCondomUsage FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            JOIN psrf p2 ON (p1.relationalid= p2.relationalid)
            WHERE (p1.birth_control=2
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND (p2.birth_control=2
                   AND EXTRACT(MONTH FROM p2.today)=prevMonth
                   AND EXTRACT(YEAR FROM p2.today)=prevYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            IF prevRecordCount = 0 THEN
		SELECT COUNT(distinct p1.relationalid) INTO fpNewCondomUsage FROM psrf p1
                JOIN member ON (p1.relationalid= member.caseid)
                WHERE (p1.birth_control=2
                        AND EXTRACT(MONTH FROM p1.today)=currentMonth
                        AND EXTRACT(YEAR FROM p1.today)=currentYear)
                AND member.mem_district=district
                AND member.mem_division=division
                AND member.mem_upazilla=upazilla
                AND member.mem_ward=ward
                AND member.mem_union=unionname
                AND member.mem_subunit=unit;
            ELSE
                SELECT COUNT(distinct p1.relationalid) INTO fpNewCondomUsage FROM psrf p1
                JOIN member ON (p1.relationalid= member.caseid)
                JOIN psrf p2 ON (p1.relationalid= p2.relationalid)
                WHERE ( p1.birth_control=2
                        AND EXTRACT(MONTH FROM p1.today)=currentMonth
                        AND EXTRACT(YEAR FROM p1.today)=currentYear)
                AND (not p2.birth_control=2
                        AND EXTRACT(MONTH FROM p2.today)=prevMonth
                        AND EXTRACT(YEAR FROM p2.today)=prevYear)
                AND member.mem_district=district
                AND member.mem_division=division
                AND member.mem_upazilla=upazilla
                AND member.mem_ward=ward
                AND member.mem_union=unionname
                AND member.mem_subunit=unit;
            END IF;

            SELECT COUNT(distinct p1.relationalid) INTO fpCurrentTotalCondomUsages FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE ( p1.birth_control=2
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO fpPrevTotalCondomUsages FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE ( p1.birth_control=2
                    AND EXTRACT(MONTH FROM p1.today)=prevMonth
                    AND EXTRACT(YEAR FROM p1.today)=prevYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO fpTotalCondomUsages FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE ( p1.birth_control=2
                    AND EXTRACT(MONTH FROM p1.today) <= currentMonth
                    AND EXTRACT(YEAR FROM p1.today) <= currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO fpLeftCondomAndStartedNone FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            JOIN psrf p2 ON (p1.relationalid= p2.relationalid)
            WHERE ( p1.using_fp = 0
                   AND p1.birth_control = 99
                   AND EXTRACT(MONTH FROM p1.today)=currentMonth
                   AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND (p2.birth_control=2
                 AND EXTRACT(MONTH FROM p2.today)=prevMonth
                 AND EXTRACT(YEAR FROM p2.today)=prevYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO fpLeftCondomAndStartedOther FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            JOIN psrf p2 ON (p1.relationalid= p2.relationalid)
            WHERE (p1.birth_control IN (1,3,4,5,6,7)
                   AND EXTRACT(MONTH FROM p1.today)=currentMonth
                   AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND (p2.birth_control=2
                 AND EXTRACT(MONTH FROM p2.today)=prevMonth
                 AND EXTRACT(YEAR FROM p2.today)=prevYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;


            /*Injectable Usage queries*/
            SELECT COUNT(distinct p1.relationalid) INTO fpOldInjectableUsage FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            JOIN psrf p2 ON (p1.relationalid= p2.relationalid)
            WHERE (p1.birth_control=3
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND (p2.birth_control=3
                   AND EXTRACT(MONTH FROM p2.today)=prevMonth
                   AND EXTRACT(YEAR FROM p2.today)=prevYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            IF prevRecordCount = 0 THEN
		SELECT COUNT(distinct p1.relationalid) INTO fpNewInjectableUsage FROM psrf p1
                JOIN member ON (p1.relationalid= member.caseid)
                WHERE (p1.birth_control=3
                        AND EXTRACT(MONTH FROM p1.today)=currentMonth
                        AND EXTRACT(YEAR FROM p1.today)=currentYear)
                AND member.mem_district=district
                AND member.mem_division=division
                AND member.mem_upazilla=upazilla
                AND member.mem_ward=ward
                AND member.mem_union=unionname
                AND member.mem_subunit=unit;
            ELSE
                SELECT COUNT(distinct p1.relationalid) INTO fpNewInjectableUsage FROM psrf p1
                JOIN member ON (p1.relationalid= member.caseid)
                JOIN psrf p2 ON (p1.relationalid= p2.relationalid)
                WHERE ( p1.birth_control=3
                        AND EXTRACT(MONTH FROM p1.today)=currentMonth
                        AND EXTRACT(YEAR FROM p1.today)=currentYear)
                AND (not p2.birth_control=3
                        AND EXTRACT(MONTH FROM p2.today)=prevMonth
                        AND EXTRACT(YEAR FROM p2.today)=prevYear)
                AND member.mem_district=district
                AND member.mem_division=division
                AND member.mem_upazilla=upazilla
                AND member.mem_ward=ward
                AND member.mem_union=unionname
                AND member.mem_subunit=unit;
            END IF;

            SELECT COUNT(distinct p1.relationalid) INTO fpCurrentTotalInjectableUsages FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE ( p1.birth_control=3
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO fpPrevTotalInjectableUsages FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE ( p1.birth_control=3
                    AND EXTRACT(MONTH FROM p1.today)=prevMonth
                    AND EXTRACT(YEAR FROM p1.today)=prevYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO fpTotalInjectableUsages FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE ( p1.birth_control=3
                    AND EXTRACT(MONTH FROM p1.today) <= currentMonth
                    AND EXTRACT(YEAR FROM p1.today) <= currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO fpLeftInjectableAndStartedNone FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            JOIN psrf p2 ON (p1.relationalid= p2.relationalid)
            WHERE ( p1.using_fp = 0
                   AND p1.birth_control = 99
                   AND EXTRACT(MONTH FROM p1.today)=currentMonth
                   AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND (p2.birth_control=3
                 AND EXTRACT(MONTH FROM p2.today)=prevMonth
                 AND EXTRACT(YEAR FROM p2.today)=prevYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO fpLeftInjectableAndStartedOther FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            JOIN psrf p2 ON (p1.relationalid= p2.relationalid)
            WHERE (p1.birth_control IN (1,2,4,5,6,7)
                   AND EXTRACT(MONTH FROM p1.today)=currentMonth
                   AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND (p2.birth_control=3
                 AND EXTRACT(MONTH FROM p2.today)=prevMonth
                 AND EXTRACT(YEAR FROM p2.today)=prevYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;


	    /*IUD Usage queries*/
            SELECT COUNT(distinct p1.relationalid) INTO fpOldIUDUsage FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            JOIN psrf p2 ON (p1.relationalid= p2.relationalid)
            WHERE (p1.birth_control=4
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND (p2.birth_control=4
                   AND EXTRACT(MONTH FROM p2.today)=prevMonth
                   AND EXTRACT(YEAR FROM p2.today)=prevYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            IF prevRecordCount = 0 THEN
				SELECT COUNT(distinct p1.relationalid) INTO fpNewIUDUsage FROM psrf p1
                JOIN member ON (p1.relationalid= member.caseid)
                WHERE (p1.birth_control=4
                        AND EXTRACT(MONTH FROM p1.today)=currentMonth
                        AND EXTRACT(YEAR FROM p1.today)=currentYear)
                AND member.mem_district=district
                AND member.mem_division=division
                AND member.mem_upazilla=upazilla
                AND member.mem_ward=ward
                AND member.mem_union=unionname
                AND member.mem_subunit=unit;
            ELSE
                SELECT COUNT(distinct p1.relationalid) INTO fpNewIUDUsage FROM psrf p1
                JOIN member ON (p1.relationalid= member.caseid)
                JOIN psrf p2 ON (p1.relationalid= p2.relationalid)
                WHERE ( p1.birth_control=4
                        AND EXTRACT(MONTH FROM p1.today)=currentMonth
                        AND EXTRACT(YEAR FROM p1.today)=currentYear)
                AND (not p2.birth_control=4
                        AND EXTRACT(MONTH FROM p2.today)=prevMonth
                        AND EXTRACT(YEAR FROM p2.today)=prevYear)
                AND member.mem_district=district
                AND member.mem_division=division
                AND member.mem_upazilla=upazilla
                AND member.mem_ward=ward
                AND member.mem_union=unionname
                AND member.mem_subunit=unit;
            END IF;

            SELECT COUNT(distinct p1.relationalid) INTO fpCurrentTotalIUDUsages FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE ( p1.birth_control=4
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO fpPrevTotalIUDUsages FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE ( p1.birth_control=4
                    AND EXTRACT(MONTH FROM p1.today)=prevMonth
                    AND EXTRACT(YEAR FROM p1.today)=prevYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO fpTotalIUDUsages FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE ( p1.birth_control=4
                    AND EXTRACT(MONTH FROM p1.today) <= currentMonth
                    AND EXTRACT(YEAR FROM p1.today) <= currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO fpLeftIUDAndStartedNone FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            JOIN psrf p2 ON (p1.relationalid= p2.relationalid)
            WHERE ( p1.using_fp = 0
                   AND p1.birth_control = 99
                   AND EXTRACT(MONTH FROM p1.today)=currentMonth
                   AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND (p2.birth_control=4
                 AND EXTRACT(MONTH FROM p2.today)=prevMonth
                 AND EXTRACT(YEAR FROM p2.today)=prevYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO fpLeftIUDAndStartedOther FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            JOIN psrf p2 ON (p1.relationalid= p2.relationalid)
            WHERE (p1.birth_control IN (1,2,3,5,6,7)
                   AND EXTRACT(MONTH FROM p1.today)=currentMonth
                   AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND (p2.birth_control=4
                 AND EXTRACT(MONTH FROM p2.today)=prevMonth
                 AND EXTRACT(YEAR FROM p2.today)=prevYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;


	    /*Implant Usage queries*/
            SELECT COUNT(distinct p1.relationalid) INTO fpOldImplantUsage FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            JOIN psrf p2 ON (p1.relationalid= p2.relationalid)
            WHERE (p1.birth_control=5
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND (p2.birth_control=5
                   AND EXTRACT(MONTH FROM p2.today)=prevMonth
                   AND EXTRACT(YEAR FROM p2.today)=prevYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            IF prevRecordCount = 0 THEN
				SELECT COUNT(distinct p1.relationalid) INTO fpNewImplantUsage FROM psrf p1
                JOIN member ON (p1.relationalid= member.caseid)
                WHERE (p1.birth_control=5
                        AND EXTRACT(MONTH FROM p1.today)=currentMonth
                        AND EXTRACT(YEAR FROM p1.today)=currentYear)
                AND member.mem_district=district
                AND member.mem_division=division
                AND member.mem_upazilla=upazilla
                AND member.mem_ward=ward
                AND member.mem_union=unionname
                AND member.mem_subunit=unit;
            ELSE
                SELECT COUNT(distinct p1.relationalid) INTO fpNewImplantUsage FROM psrf p1
                JOIN member ON (p1.relationalid= member.caseid)
                JOIN psrf p2 ON (p1.relationalid= p2.relationalid)
                WHERE ( p1.birth_control=5
                        AND EXTRACT(MONTH FROM p1.today)=currentMonth
                        AND EXTRACT(YEAR FROM p1.today)=currentYear)
                AND (not p2.birth_control=5
                        AND EXTRACT(MONTH FROM p2.today)=prevMonth
                        AND EXTRACT(YEAR FROM p2.today)=prevYear)
                AND member.mem_district=district
                AND member.mem_division=division
                AND member.mem_upazilla=upazilla
                AND member.mem_ward=ward
                AND member.mem_union=unionname
                AND member.mem_subunit=unit;
            END IF;

            SELECT COUNT(distinct p1.relationalid) INTO fpCurrentTotalImplantUsages FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE ( p1.birth_control=5
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO fpPrevTotalImplantUsages FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE ( p1.birth_control=5
                    AND EXTRACT(MONTH FROM p1.today)=prevMonth
                    AND EXTRACT(YEAR FROM p1.today)=prevYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO fpTotalImplantUsages FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE ( p1.birth_control=5
                    AND EXTRACT(MONTH FROM p1.today) <= currentMonth
                    AND EXTRACT(YEAR FROM p1.today) <= currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO fpLeftImplantAndStartedNone FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            JOIN psrf p2 ON (p1.relationalid= p2.relationalid)
            WHERE ( p1.using_fp = 0
                   AND p1.birth_control = 99
                   AND EXTRACT(MONTH FROM p1.today)=currentMonth
                   AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND (p2.birth_control=5
                 AND EXTRACT(MONTH FROM p2.today)=prevMonth
                 AND EXTRACT(YEAR FROM p2.today)=prevYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO fpLeftImplantAndStartedOther FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            JOIN psrf p2 ON (p1.relationalid= p2.relationalid)
            WHERE (p1.birth_control IN (1,2,3,4,6,7)
                   AND EXTRACT(MONTH FROM p1.today)=currentMonth
                   AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND (p2.birth_control=5
                 AND EXTRACT(MONTH FROM p2.today)=prevMonth
                 AND EXTRACT(YEAR FROM p2.today)=prevYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;


            /*MalePermanent Method Usage queries*/
            SELECT COUNT(distinct p1.relationalid) INTO fpOldMalePermanentUsage FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            JOIN psrf p2 ON (p1.relationalid= p2.relationalid)
            WHERE (p1.birth_control=6
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND (p2.birth_control=6
                   AND EXTRACT(MONTH FROM p2.today)=prevMonth
                   AND EXTRACT(YEAR FROM p2.today)=prevYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            IF prevRecordCount = 0 THEN
				SELECT COUNT(distinct p1.relationalid) INTO fpNewMalePermanentUsage FROM psrf p1
                JOIN member ON (p1.relationalid= member.caseid)
                WHERE (p1.birth_control=6
                        AND EXTRACT(MONTH FROM p1.today)=currentMonth
                        AND EXTRACT(YEAR FROM p1.today)=currentYear)
                AND member.mem_district=district
                AND member.mem_division=division
                AND member.mem_upazilla=upazilla
                AND member.mem_ward=ward
                AND member.mem_union=unionname
                AND member.mem_subunit=unit;
            ELSE
                SELECT COUNT(distinct p1.relationalid) INTO fpNewMalePermanentUsage FROM psrf p1
                JOIN member ON (p1.relationalid= member.caseid)
                JOIN psrf p2 ON (p1.relationalid= p2.relationalid)
                WHERE ( p1.birth_control=6
                        AND EXTRACT(MONTH FROM p1.today)=currentMonth
                        AND EXTRACT(YEAR FROM p1.today)=currentYear)
                AND (not p2.birth_control=6
                        AND EXTRACT(MONTH FROM p2.today)=prevMonth
                        AND EXTRACT(YEAR FROM p2.today)=prevYear)
                AND member.mem_district=district
                AND member.mem_division=division
                AND member.mem_upazilla=upazilla
                AND member.mem_ward=ward
                AND member.mem_union=unionname
                AND member.mem_subunit=unit;
            END IF;

            SELECT COUNT(distinct p1.relationalid) INTO fpCurrentTotalMalePermanentUsages FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE ( p1.birth_control=6
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO fpPrevTotalMalePermanentUsages FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE ( p1.birth_control=6
                    AND EXTRACT(MONTH FROM p1.today)=prevMonth
                    AND EXTRACT(YEAR FROM p1.today)=prevYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO fpTotalMalePermanentUsages FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE ( p1.birth_control=6
                    AND EXTRACT(MONTH FROM p1.today) <= currentMonth
                    AND EXTRACT(YEAR FROM p1.today) <= currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;


            /*FemalePermanent Method Usage queries*/
            SELECT COUNT(distinct p1.relationalid) INTO fpOldFemalePermanentUsage FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            JOIN psrf p2 ON (p1.relationalid= p2.relationalid)
            WHERE (p1.birth_control=7
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND (p2.birth_control=7
                   AND EXTRACT(MONTH FROM p2.today)=prevMonth
                   AND EXTRACT(YEAR FROM p2.today)=prevYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            IF prevRecordCount = 0 THEN
				SELECT COUNT(distinct p1.relationalid) INTO fpNewFemalePermanentUsage FROM psrf p1
                JOIN member ON (p1.relationalid= member.caseid)
                WHERE (p1.birth_control=7
                        AND EXTRACT(MONTH FROM p1.today)=currentMonth
                        AND EXTRACT(YEAR FROM p1.today)=currentYear)
                AND member.mem_district=district
                AND member.mem_division=division
                AND member.mem_upazilla=upazilla
                AND member.mem_ward=ward
                AND member.mem_union=unionname
                AND member.mem_subunit=unit;
            ELSE
                SELECT COUNT(distinct p1.relationalid) INTO fpNewFemalePermanentUsage FROM psrf p1
                JOIN member ON (p1.relationalid= member.caseid)
                JOIN psrf p2 ON (p1.relationalid= p2.relationalid)
                WHERE ( p1.birth_control=7
                        AND EXTRACT(MONTH FROM p1.today)=currentMonth
                        AND EXTRACT(YEAR FROM p1.today)=currentYear)
                AND (not p2.birth_control=7
                        AND EXTRACT(MONTH FROM p2.today)=prevMonth
                        AND EXTRACT(YEAR FROM p2.today)=prevYear)
                AND member.mem_district=district
                AND member.mem_division=division
                AND member.mem_upazilla=upazilla
                AND member.mem_ward=ward
                AND member.mem_union=unionname
                AND member.mem_subunit=unit;
            END IF;

            SELECT COUNT(distinct p1.relationalid) INTO fpCurrentTotalFemalePermanentUsages FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE ( p1.birth_control=7
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO fpPrevTotalFemalePermanentUsages FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE ( p1.birth_control=7
                    AND EXTRACT(MONTH FROM p1.today)=prevMonth
                    AND EXTRACT(YEAR FROM p1.today)=prevYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO fpTotalFemalePermanentUsages FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE ( p1.birth_control=7
                    AND EXTRACT(MONTH FROM p1.today) <= currentMonth
                    AND EXTRACT(YEAR FROM p1.today) <= currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;


	    /*Eligible Couple queries*/
            SELECT COUNT(distinct p1.relationalid) INTO fpCurrentEligibleCoupleCount FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.visit_status=1
                   AND EXTRACT(MONTH FROM p1.today)=currentMonth
                   AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO fpPrevEligibleCoupleCount FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.visit_status=1
                   AND EXTRACT(MONTH FROM p1.today)=prevMonth
                   AND EXTRACT(YEAR FROM p1.today)=prevYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO fpTotalEligibleCoupleCount FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (EXTRACT(MONTH FROM p1.today) <= currentMonth
                    AND EXTRACT(YEAR FROM p1.today) <= currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

			SELECT COUNT(distinct p1.relationalid) INTO fpNewEligibleCoupleCount FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (EXTRACT(MONTH FROM member.today) = currentMonth
                    AND EXTRACT(YEAR FROM member.today) = currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

	   /*Total counts queries*/
           fpTotalOldUsages := fpOldPillUsage + fpOldCondomUsage + fpOldInjectableUsage
                               + fpOldIUDUsage + fpOldImplantUsage
                               + fpOldMalePermanentUsage + fpOldFemalePermanentUsage;

           fpTotalNewUsages := fpNewPillUsage + fpNewCondomUsage + fpNewInjectableUsage
                               + fpNewIUDUsage + fpNewImplantUsage
                               + fpNewMalePermanentUsage + fpNewFemalePermanentUsage;

            fpTotalCurrentUsages := fpCurrentTotalPillUsages + fpCurrentTotalCondomUsages
                                    + fpCurrentTotalInjectableUsages + fpCurrentTotalIUDUsages
                                    + fpCurrentTotalImplantUsages + fpCurrentTotalMalePermanentUsages
                                    + fpCurrentTotalFemalePermanentUsages;

            fpTotalPrevUsages := fpPrevTotalPillUsages + fpPrevTotalCondomUsages + fpPrevTotalInjectableUsages
                                + fpPrevTotalIUDUsages + fpPrevTotalImplantUsages
                                + fpPrevTotalMalePermanentUsages + fpPrevTotalFemalePermanentUsages;

	    fpTotalUsages := fpTotalPillUsages + fpTotalCondomUsages + fpTotalInjectableUsages
                                + fpTotalIUDUsages + fpTotalImplantUsages
                                + fpTotalMalePermanentUsages + fpTotalFemalePermanentUsages;

           fpTotalStartedNone := fpLeftPillAndStartedNone + fpLeftCondomAndStartedNone
                                 + fpLeftInjectableAndStartedNone + fpLeftIUDAndStartedNone
                                 + fpLeftImplantAndStartedNone;


           fpTotalStartedOther := fpLeftPillAndStartedOther + fpLeftCondomAndStartedOther
                                  + fpLeftInjectableAndStartedOther + fpLeftIUDAndStartedOther
                                  + fpLeftImplantAndStartedOther;

           IF fpTotalEligibleCoupleCount != 0 THEN
	       fpCAR := (fpTotalUsages/fpTotalEligibleCoupleCount) * 100;
           END IF;


           /*Maternity Care Report Queries*/
           IF prevRecordCount = 0 THEN
				SELECT COUNT(distinct p1.relationalid) INTO mcCurrentNewPregnantCount FROM psrf p1
                JOIN member ON (p1.relationalid= member.caseid)
                WHERE (p1.preg_status=1
                        AND EXTRACT(MONTH FROM p1.today)=currentMonth
                        AND EXTRACT(YEAR FROM p1.today)=currentYear)
                AND member.mem_district=district
                AND member.mem_division=division
                AND member.mem_upazilla=upazilla
                AND member.mem_ward=ward
                AND member.mem_union=unionname
                AND member.mem_subunit=unit;
            ELSE
                SELECT COUNT(distinct p1.relationalid) INTO mcCurrentNewPregnantCount FROM psrf p1
                JOIN member ON (p1.relationalid= member.caseid)
                JOIN psrf p2 ON (p1.relationalid= p2.relationalid)
                WHERE ( p1.preg_status=1
                        AND EXTRACT(MONTH FROM p1.today)=currentMonth
                        AND EXTRACT(YEAR FROM p1.today)=currentYear)
                AND (not p2.preg_status=0
                        AND EXTRACT(MONTH FROM p2.today)=prevMonth
                        AND EXTRACT(YEAR FROM p2.today)=prevYear)
                AND member.mem_district=district
                AND member.mem_division=division
                AND member.mem_upazilla=upazilla
                AND member.mem_ward=ward
                AND member.mem_union=unionname
                AND member.mem_subunit=unit;
            END IF;

            SELECT COUNT(distinct p1.relationalid) INTO mcCurrentOldPregnantCount FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.preg_status=1
                    AND EXTRACT(MONTH FROM p1.today)<currentMonth
                    AND EXTRACT(YEAR FROM p1.today)<currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO mcCurrentTotalPregnantCount FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.preg_status=1
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO mcPrevPregnantCount FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.preg_status=1
                    AND EXTRACT(MONTH FROM p1.today)=prevMonth
                    AND EXTRACT(YEAR FROM p1.today)=prevYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO mcTotalPregnantCount FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.preg_status=1
                    AND EXTRACT(MONTH FROM p1.today)<=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)<=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct a1.relationalid) INTO mcANCVisit1Info FROM anc a1
            JOIN member ON (a1.relationalid= member.caseid)
            WHERE (a1.ancName='ANC1'
                    AND EXTRACT(MONTH FROM a1.today)=currentMonth
                    AND EXTRACT(YEAR FROM a1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct a1.relationalid) INTO mcANCVisit1Service FROM anc a1
            JOIN member ON (a1.relationalid= member.caseid)
            WHERE (a1.ancName='ANC1'
                    AND EXTRACT(MONTH FROM a1.today)=currentMonth
                    AND EXTRACT(YEAR FROM a1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct a1.relationalid) INTO mcANCVisit2Info FROM anc a1
            JOIN member ON (a1.relationalid= member.caseid)
            WHERE (a1.ancName='ANC2'
                    AND EXTRACT(MONTH FROM a1.today)=currentMonth
                    AND EXTRACT(YEAR FROM a1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct a1.relationalid) INTO mcANCVisit2Service FROM anc a1
            JOIN member ON (a1.relationalid= member.caseid)
            WHERE (a1.ancName='ANC2'
                    AND EXTRACT(MONTH FROM a1.today)=currentMonth
                    AND EXTRACT(YEAR FROM a1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct a1.relationalid) INTO mcANCVisit3Info FROM anc a1
            JOIN member ON (a1.relationalid= member.caseid)
            WHERE (a1.ancName='ANC3'
                    AND EXTRACT(MONTH FROM a1.today)=currentMonth
                    AND EXTRACT(YEAR FROM a1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct a1.relationalid) INTO mcANCVisit3Service FROM anc a1
            JOIN member ON (a1.relationalid= member.caseid)
            WHERE (a1.ancName='ANC3'
                    AND EXTRACT(MONTH FROM a1.today)=currentMonth
                    AND EXTRACT(YEAR FROM a1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

             SELECT COUNT(distinct a1.relationalid) INTO mcANCVisit4Info FROM anc a1
            JOIN member ON (a1.relationalid= member.caseid)
            WHERE (a1.ancName='ANC4'
                    AND EXTRACT(MONTH FROM a1.today)=currentMonth
                    AND EXTRACT(YEAR FROM a1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct a1.relationalid) INTO mcANCVisit4Service FROM anc a1
            JOIN member ON (a1.relationalid= member.caseid)
            WHERE (a1.ancName='ANC4'
                    AND EXTRACT(MONTH FROM a1.today)=currentMonth
                    AND EXTRACT(YEAR FROM a1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct b1.relationalid) INTO mcBirthAtHomeWithTrainedPerson FROM bnf b1
            JOIN member ON (b1.relationalid= member.caseid)
            WHERE (b1.where_delivered = 1
                    AND b1.who_delivered in (1,2,3,4,5,6)
                    AND EXTRACT(MONTH FROM b1.today)=currentMonth
                    AND EXTRACT(YEAR FROM b1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct b1.relationalid) INTO mcNormalBirthAtHospitalOrClinic FROM bnf b1
            JOIN member ON (b1.relationalid= member.caseid)
            WHERE (b1.where_delivered in (2,3,4,5,6,7)
                    AND b1.Delivery_Type = 1
                    AND EXTRACT(MONTH FROM b1.today)=currentMonth
                    AND EXTRACT(YEAR FROM b1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct b1.relationalid) INTO mcCesareanBirthAtHospitalOrClinic FROM bnf b1
            JOIN member ON (b1.relationalid= member.caseid)
            WHERE (b1.where_delivered in (2,3,4,5,6,7)
                    AND b1.Delivery_Type = 2
                    AND EXTRACT(MONTH FROM b1.today)=currentMonth
                    AND EXTRACT(YEAR FROM b1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO mcMotherPNCVisit1Info FROM pnc p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.pncname='PNC1'
                    AND p1.visit_status in (1,3)
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO mcMotherPNCVisit1Service FROM pnc p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.pncname='PNC1'
                    AND p1.has_pnc_given_on_time=1
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO mcMotherPNCVisit2Info FROM pnc p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.pncname='PNC2'
                    AND p1.visit_status in (1,3)
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO mcMotherPNCVisit2Service FROM pnc p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.pncname='PNC2'
                    AND p1.has_pnc_given_on_time=1
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO mcMotherPNCVisit3Info FROM pnc p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.pncname='PNC3'
                    AND p1.visit_status in (1,3)
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO mcMotherPNCVisit3Service FROM pnc p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.pncname='PNC3'
                    AND p1.has_pnc_given_on_time=1
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO mcMotherPNCVisit4Info FROM pnc p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.pncname='PNC4'
                    AND p1.visit_status in (1,3)
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO mcMotherPNCVisit4Service FROM pnc p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.pncname='PNC4'
                    AND p1.has_pnc_given_on_time=1
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO mcChildPNCVisit1Info FROM pnc p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.pncname='PNC1'
                    AND p1.visit_status in (1,3)
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO mcChildPNCVisit1Service FROM pnc p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.pncname='PNC1'
                    AND p1.has_pnc_given_on_time=1
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO mcChildPNCVisit2Info FROM pnc p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.pncname='PNC2'
                    AND p1.visit_status in (1,3)
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO mcChildPNCVisit2Service FROM pnc p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.pncname='PNC2'
                    AND p1.has_pnc_given_on_time=1
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO mcChildPNCVisit3Info FROM pnc p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.pncname='PNC3'
                    AND p1.visit_status in (1,3)
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO mcChildPNCVisit3Service FROM pnc p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.pncname='PNC3'
                    AND p1.has_pnc_given_on_time=1
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO mcChildPNCVisit4Info FROM pnc p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.pncname='PNC4'
                    AND p1.visit_status in (1,3)
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO mcChildPNCVisit4Service FROM pnc p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.pncname='PNC4'
                    AND p1.has_pnc_given_on_time=1
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct a1.relationalid) INTO mcReferredComplexPregnant FROM anc a1
            JOIN member ON (a1.relationalid= member.caseid)
            WHERE (a1.is_reffered=1
                    AND EXTRACT(MONTH FROM a1.today)=currentMonth
                    AND EXTRACT(YEAR FROM a1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO mcTTDoseOne FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.tt_dose like '%1%'
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO mcTTDoseTwo FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.tt_dose like '%2%'
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO mcTTDoseThree FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.tt_dose like '%3%'
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO mcTTDoseFour FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.tt_dose like '%4%'
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO mcTTDoseFive FROM psrf p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.tt_dose like '%5%'
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct b1.relationalid) INTO mcMisoprostolReceivedCount FROM bnf b1
            JOIN member ON (b1.relationalid= member.caseid)
            WHERE (b1.misoprostol_received=1
                    AND EXTRACT(MONTH FROM b1.today)=currentMonth
                    AND EXTRACT(YEAR FROM b1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct a1.relationalid) INTO mcCounsellingOnChangesOfAdolescent
            FROM adolescent a1
            JOIN member ON (a1.relationalid= member.caseid)
            WHERE (a1.councelling=4
                    AND EXTRACT(MONTH FROM a1.today)=currentMonth
                    AND EXTRACT(YEAR FROM a1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct a1.relationalid) INTO mcCounsellingBadEffectOnChildMarriageAndTeenPregnancy
            FROM adolescent a1
            JOIN member ON (a1.relationalid= member.caseid)
            WHERE (a1.councelling=1
                    AND EXTRACT(MONTH FROM a1.today)=currentMonth
                    AND EXTRACT(YEAR FROM a1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct a1.relationalid) INTO mcCounsellingTeenagersOnTakingIronAndFolicAcid
            FROM adolescent a1
            JOIN member ON (a1.relationalid= member.caseid)
            WHERE (a1.councelling=2
                    AND EXTRACT(MONTH FROM a1.today)=currentMonth
                    AND EXTRACT(YEAR FROM a1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct a1.relationalid) INTO mcCounsellingOnInfectionOfDiseases
            FROM adolescent a1
            JOIN member ON (a1.relationalid= member.caseid)
            WHERE (a1.councelling=6
                    AND EXTRACT(MONTH FROM a1.today)=currentMonth
                    AND EXTRACT(YEAR FROM a1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;


            /*Child Care Report Queries*/
            SELECT COUNT(distinct p1.relationalid) INTO ccIsCleanedInfo
            FROM pnc p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.is_cleaned=1
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO ccIsCleanedService
            FROM pnc p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.is_cleaned=1
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO ccUsedChlorhexidinInfo
            FROM pnc p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.chlorhexidin=1
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO ccUsedChlorhexidinService
            FROM pnc p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.chlorhexidin=1
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct p1.relationalid) INTO ccFedBreastMilkCount
            FROM pnc p1
            JOIN member ON (p1.relationalid= member.caseid)
            WHERE (p1.breasmilk_Fed=1
                    AND EXTRACT(MONTH FROM p1.today)=currentMonth
                    AND EXTRACT(YEAR FROM p1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct c1.relationalid) INTO ccBcgCount
            FROM child c1
            JOIN member ON (c1.relationalid= member.caseid)
            WHERE (c1.vaccines LIKE '%BCG%'
                    AND EXTRACT(MONTH FROM c1.today)=currentMonth
                    AND EXTRACT(YEAR FROM c1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct c1.relationalid) INTO ccOpv1Andpcv1Andpenta1Count
            FROM child c1
            JOIN member ON (c1.relationalid= member.caseid)
            WHERE (c1.vaccines LIKE '%OPV1%'
                    AND c1.vaccines LIKE '%PCV1%'
                    AND c1.vaccines LIKE '%Penta1%'
                    AND EXTRACT(MONTH FROM c1.today)=currentMonth
                    AND EXTRACT(YEAR FROM c1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct c1.relationalid) INTO ccOpv2Andpcv2Andpenta2Count
            FROM child c1
            JOIN member ON (c1.relationalid= member.caseid)
            WHERE (c1.vaccines LIKE '%OPV2%'
                    AND c1.vaccines LIKE '%PCV2%'
                    AND c1.vaccines LIKE '%Penta2%'
                    AND EXTRACT(MONTH FROM c1.today)=currentMonth
                    AND EXTRACT(YEAR FROM c1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct c1.relationalid) INTO ccOpv3Andpenta3Count
            FROM child c1
            JOIN member ON (c1.relationalid= member.caseid)
            WHERE (c1.vaccines LIKE '%OPV3%'
                    AND c1.vaccines LIKE '%Penta3%'
                    AND EXTRACT(MONTH FROM c1.today)=currentMonth
                    AND EXTRACT(YEAR FROM c1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct c1.relationalid) INTO ccPcv3Count
            FROM child c1
            JOIN member ON (c1.relationalid= member.caseid)
            WHERE ( c1.vaccines LIKE '%PCV3%'
                    AND EXTRACT(MONTH FROM c1.today)=currentMonth
                    AND EXTRACT(YEAR FROM c1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct c1.relationalid) INTO ccMrAndopv4Count
            FROM child c1
            JOIN member ON (c1.relationalid= member.caseid)
            WHERE (c1.vaccines LIKE '%OPV4%'
                    AND c1.vaccines LIKE '%MR%'
                    AND EXTRACT(MONTH FROM c1.today)=currentMonth
                    AND EXTRACT(YEAR FROM c1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct c1.relationalid) INTO ccReferredChildOfDangerousDiseasesInfo
            FROM child c1
            JOIN member ON (c1.relationalid= member.caseid)
            WHERE (c1.diseases_Prob=1
                    AND EXTRACT(MONTH FROM c1.today)=currentMonth
                    AND EXTRACT(YEAR FROM c1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct c1.relationalid) INTO ccReferredChildOfDangerousDiseasesService
            FROM child c1
            JOIN member ON (c1.relationalid= member.caseid)
            WHERE (c1.diseases_Prob=1
                    AND EXTRACT(MONTH FROM c1.today)=currentMonth
                    AND EXTRACT(YEAR FROM c1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct c1.relationalid) INTO ccReferredChildOfPneumoniaInfo
            FROM child c1
            JOIN member ON (c1.relationalid= member.caseid)
            WHERE (c1.diseases_Prob=2
                    AND EXTRACT(MONTH FROM c1.today)=currentMonth
                    AND EXTRACT(YEAR FROM c1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct c1.relationalid) INTO ccReferredChildOfPneumoniaService
            FROM child c1
            JOIN member ON (c1.relationalid= member.caseid)
            WHERE (c1.diseases_Prob=2
                    AND EXTRACT(MONTH FROM c1.today)=currentMonth
                    AND EXTRACT(YEAR FROM c1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct c1.relationalid) INTO ccReferredChildOfDiarrheaInfo
            FROM child c1
            JOIN member ON (c1.relationalid= member.caseid)
            WHERE (c1.diseases_Prob=3
                    AND EXTRACT(MONTH FROM c1.today)=currentMonth
                    AND EXTRACT(YEAR FROM c1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct c1.relationalid) INTO ccReferredChildOfDiarrheaService
            FROM child c1
            JOIN member ON (c1.relationalid= member.caseid)
            WHERE (c1.diseases_Prob=3
                    AND EXTRACT(MONTH FROM c1.today)=currentMonth
                    AND EXTRACT(YEAR FROM c1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;


            /*Birth and Death Report Queries*/
            SELECT SUM(b1.num_live_birth) INTO bdTotalLiveBirth
            FROM bnf b1
            JOIN member ON (b1.relationalid= member.caseid)
            WHERE ( EXTRACT(MONTH FROM b1.today)=currentMonth
                    AND EXTRACT(YEAR FROM b1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            If bdTotalLiveBirth IS NULL THEN
                bdTotalLiveBirth := 0;
            END If;

            SELECT COUNT(distinct b1.relationalid) INTO bdtotalChildWithUnderWeight
            FROM bnf b1
            JOIN member ON (b1.relationalid= member.caseid)
            WHERE (b1.child_weight < 2.5
                    AND EXTRACT(MONTH FROM b1.today)=currentMonth
                    AND EXTRACT(YEAR FROM b1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct b1.relationalid) INTO bdTotalPrematureChild
            FROM bnf b1
            JOIN member ON (b1.relationalid= member.caseid)
            WHERE (b1.premature_birth=1
                    AND EXTRACT(MONTH FROM b1.today)=currentMonth
                    AND EXTRACT(YEAR FROM b1.today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct d1.relationalid) INTO bdDeathLessThan7Days
            FROM deathreg d1
            JOIN member ON (d1.relationalid= member.caseid)
            WHERE (d1.deceased_age_group = 1
                    AND EXTRACT(MONTH FROM d1.death_today)=currentMonth
                    AND EXTRACT(YEAR FROM d1.death_today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct d1.relationalid) INTO bdDeathLessThan28Days
            FROM deathreg d1
            JOIN member ON (d1.relationalid= member.caseid)
            WHERE (d1.deceased_age_group = 2
                    AND EXTRACT(MONTH FROM d1.death_today)=currentMonth
                    AND EXTRACT(YEAR FROM d1.death_today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct d1.relationalid) INTO bdDeathLessThan1Yr
            FROM deathreg d1
            JOIN member ON (d1.relationalid= member.caseid)
            WHERE (d1.deceased_age_group = 3
                    AND EXTRACT(MONTH FROM d1.death_today)=currentMonth
                    AND EXTRACT(YEAR FROM d1.death_today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            bdTotalDeathLessThan1Yr := bdDeathLessThan7Days + bdDeathLessThan28Days
                                       + bdDeathLessThan1Yr;

            SELECT COUNT(distinct d1.relationalid) INTO bdDeathLessThan5Yr
            FROM deathreg d1
            JOIN member ON (d1.relationalid= member.caseid)
            WHERE (d1.deceased_age_group = 4
                    AND EXTRACT(MONTH FROM d1.death_today)=currentMonth
                    AND EXTRACT(YEAR FROM d1.death_today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct d1.relationalid) INTO bdDeathOfMother
            FROM deathreg d1
            JOIN member ON (d1.relationalid= member.caseid)
            WHERE (d1.deceased_age_group = 5
                    AND EXTRACT(MONTH FROM d1.death_today)=currentMonth
                    AND EXTRACT(YEAR FROM d1.death_today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct d1.relationalid) INTO bdDeathOfOther
            FROM deathreg d1
            JOIN member ON (d1.relationalid= member.caseid)
            WHERE (d1.deceased_age_group = 6
                    AND EXTRACT(MONTH FROM d1.death_today)=currentMonth
                    AND EXTRACT(YEAR FROM d1.death_today)=currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            bdTotalDeathCount := bdTotalDeathLessThan1Yr + bdDeathLessThan5Yr
                                 + bdDeathOfMother + bdDeathOfOther;

            /*Nutrition Report Queries*/
            SELECT COUNT(distinct n1.relationalid) INTO wnCounsellingIronForPregWoman
            FROM nutrition n1
            JOIN member ON (n1.relationalid= member.caseid)
            JOIN psrf p1 ON (p1.relationalid= member.caseid)
            WHERE ( n1.mother_nutrition = 1
                    AND p1.preg_status = 1
                    AND EXTRACT(MONTH FROM n1.visit_date) = currentMonth
                    AND EXTRACT(YEAR FROM n1.visit_date) = currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct n1.relationalid) INTO wnCounsellingIronForMother
            FROM nutrition n1
            JOIN member ON (n1.relationalid= member.caseid)
            JOIN psrf p1 ON (p1.relationalid= member.caseid)
            WHERE ( n1.mother_nutrition = 1
                    AND NOT p1.preg_status = 1
                    AND EXTRACT(MONTH FROM n1.visit_date) = currentMonth
                    AND EXTRACT(YEAR FROM n1.visit_date) = currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct n1.relationalid) INTO wnDistributionIronForPregWoman
            FROM nutrition n1
            JOIN member ON (n1.relationalid= member.caseid)
            JOIN psrf p1 ON (p1.relationalid= member.caseid)
            WHERE ( n1.distrinuted_nutrition = 1
                    AND p1.preg_status = 1
                    AND EXTRACT(MONTH FROM n1.visit_date) = currentMonth
                    AND EXTRACT(YEAR FROM n1.visit_date) = currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct n1.relationalid) INTO wnDistributionIronForMother
            FROM nutrition n1
            JOIN member ON (n1.relationalid= member.caseid)
            JOIN psrf p1 ON (p1.relationalid= member.caseid)
            WHERE ( n1.distrinuted_nutrition = 1
                    AND NOT p1.preg_status = 1
                    AND EXTRACT(MONTH FROM n1.visit_date) = currentMonth
                    AND EXTRACT(YEAR FROM n1.visit_date) = currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct n1.relationalid) INTO wnCounsellingOnBreastMilkForPregWoman
            FROM nutrition n1
            JOIN member ON (n1.relationalid= member.caseid)
            JOIN psrf p1 ON (p1.relationalid= member.caseid)
            WHERE ( n1.mother_nutrition = 3
                    AND p1.preg_status = 1
                    AND EXTRACT(MONTH FROM n1.visit_date) = currentMonth
                    AND EXTRACT(YEAR FROM n1.visit_date) = currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct n1.relationalid) INTO wnCounsellingOnBreastMilkForMother
            FROM nutrition n1
            JOIN member ON (n1.relationalid= member.caseid)
            JOIN psrf p1 ON (p1.relationalid= member.caseid)
            WHERE ( n1.mother_nutrition = 3
                    AND NOT p1.preg_status = 1
                    AND EXTRACT(MONTH FROM n1.visit_date) = currentMonth
                    AND EXTRACT(YEAR FROM n1.visit_date) = currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct n1.relationalid) INTO wnCounsellingOnFeedingMNP
            FROM nutrition n1
            JOIN member ON (n1.relationalid= member.caseid)
            JOIN psrf p1 ON (p1.relationalid= member.caseid)
            WHERE ( n1.mother_nutrition = 2
                    AND NOT p1.preg_status = 1
                    AND EXTRACT(MONTH FROM n1.visit_date) = currentMonth
                    AND EXTRACT(YEAR FROM n1.visit_date) = currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct n1.relationalid) INTO cnBreastFeedingWithin1Hour
            FROM nutrition n1
            JOIN member ON (n1.relationalid= member.caseid)
            WHERE ( n1.child_nutrition = 1
                    AND EXTRACT(MONTH FROM n1.visit_date) = currentMonth
                    AND EXTRACT(YEAR FROM n1.visit_date) = currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct n1.relationalid) INTO cnBreastFeedingUntill6Month
            FROM nutrition n1
            JOIN member ON (n1.relationalid= member.caseid)
            WHERE ( n1.child_nutrition = 2
                    AND EXTRACT(MONTH FROM n1.visit_date) = currentMonth
                    AND EXTRACT(YEAR FROM n1.visit_date) = currentYear)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct n1.relationalid) INTO cnComplementaryFoodForChild6TO23
            FROM nutrition n1
            JOIN member ON (n1.relationalid= member.caseid)
            WHERE ( n1.child_nutrition = 3
                    AND EXTRACT(MONTH FROM n1.visit_date) = currentMonth
                    AND EXTRACT(YEAR FROM n1.visit_date) = currentYear
                    AND age(member.member_birth_date) >= child6Month
                    AND age(member.member_birth_date) < child24Months)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct n1.relationalid) INTO cnComplementaryFoodForChild24to59
            FROM nutrition n1
            JOIN member ON (n1.relationalid= member.caseid)
            WHERE ( n1.child_nutrition = 3
                    AND EXTRACT(MONTH FROM n1.visit_date) = currentMonth
                    AND EXTRACT(YEAR FROM n1.visit_date) = currentYear
                    AND age(member.member_birth_date) >= child24months
                    AND age(member.member_birth_date) < child60months)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct n1.relationalid) INTO cnContractedMAMChildZeroToSix
            FROM nutrition n1
            JOIN member ON (n1.relationalid= member.caseid)
            WHERE ( n1.child_nutrition = 4
                    AND EXTRACT(MONTH FROM n1.visit_date) = currentMonth
                    AND EXTRACT(YEAR FROM n1.visit_date) = currentYear
                    AND age(member.member_birth_date) < child6Month)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct n1.relationalid) INTO cnContractedMAMChild6TO23
            FROM nutrition n1
            JOIN member ON (n1.relationalid= member.caseid)
            WHERE ( n1.child_nutrition = 4
                    AND EXTRACT(MONTH FROM n1.visit_date) = currentMonth
                    AND EXTRACT(YEAR FROM n1.visit_date) = currentYear
                    AND age(member.member_birth_date) >= child6Month
                    AND age(member.member_birth_date) < child24Months)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct n1.relationalid) INTO cnContractedMAMChild24TO59
            FROM nutrition n1
            JOIN member ON (n1.relationalid= member.caseid)
            WHERE ( n1.child_nutrition = 4
                    AND EXTRACT(MONTH FROM n1.visit_date) = currentMonth
                    AND EXTRACT(YEAR FROM n1.visit_date) = currentYear
                    AND age(member.member_birth_date) >= child24Months
                    AND age(member.member_birth_date) < child60Months)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct n1.relationalid) INTO cnContractedSAMChildZeroToSix
            FROM nutrition n1
            JOIN member ON (n1.relationalid= member.caseid)
            WHERE ( n1.child_nutrition = 5
                    AND EXTRACT(MONTH FROM n1.visit_date) = currentMonth
                    AND EXTRACT(YEAR FROM n1.visit_date) = currentYear
                    AND age(member.member_birth_date) < child6Month)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct n1.relationalid) INTO cnContractedSAMChild6TO23
            FROM nutrition n1
            JOIN member ON (n1.relationalid= member.caseid)
            WHERE ( n1.child_nutrition = 5
                    AND EXTRACT(MONTH FROM n1.visit_date) = currentMonth
                    AND EXTRACT(YEAR FROM n1.visit_date) = currentYear
                    AND age(member.member_birth_date) >= child6Month
                    AND age(member.member_birth_date) < child24Months)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

            SELECT COUNT(distinct n1.relationalid) INTO cnContractedSAMChild24TO59
            FROM nutrition n1
            JOIN member ON (n1.relationalid= member.caseid)
            WHERE ( n1.child_nutrition = 5
                    AND EXTRACT(MONTH FROM n1.visit_date) = currentMonth
                    AND EXTRACT(YEAR FROM n1.visit_date) = currentYear
                    AND age(member.member_birth_date) >= child24Months
                    AND age(member.member_birth_date) < child60Months)
            AND member.mem_district=district
            AND member.mem_division=division
            AND member.mem_upazilla=upazilla
            AND member.mem_ward=ward
            AND member.mem_union=unionname
            AND member.mem_subunit=unit;

           INSERT INTO mis1report (id, fpOldPillUsage, fpNewPillUsage, fpCurrentTotalPillUsages
                                         , fpPrevTotalPillUsages, fpTotalPillUsages, fpLeftPillAndStartedNone
                                         , fpLeftPillAndStartedOther
                                         , fpOldCondomUsage, fpNewCondomUsage
                                         , fpCurrentTotalCondomUsages, fpPrevTotalCondomUsages
                                         , fpTotalCondomUsages, fpLeftCondomAndStartedNone
                                         , fpLeftCondomAndStartedOther
                                         , fpOldInjectableUsage, fpNewInjectableUsage
                                         , fpCurrentTotalInjectableUsages, fpPrevTotalInjectableUsages
                                         , fpTotalInjectableUsages, fpLeftInjectableAndStartedNone
                                         , fpLeftInjectableAndStartedOther
                                         , fpOldIUDUsage, fpNewIUDUsage
                                         , fpCurrentTotalIUDUsages, fpPrevTotalIUDUsages
                                         , fpTotalIUDUsages, fpLeftIUDAndStartedNone
                                         , fpLeftIUDAndStartedOther
                                         , fpOldImplantUsage, fpNewImplantUsage
                                         , fpCurrentTotalImplantUsages, fpPrevTotalImplantUsages
                                         , fpTotalImplantUsages, fpLeftImplantAndStartedNone
                                         , fpLeftImplantAndStartedOther
                                         , fpOldMalePermanentUsage, fpNewMalePermanentUsage
                                         , fpCurrentTotalMalePermanentUsages, fpPrevTotalMalePermanentUsages
                                         , fpTotalMalePermanentUsages
                                         , fpOldFemalePermanentUsage, fpNewFemalePermanentUsage
                                         , fpCurrentTotalFemalePermanentUsages, fpPrevTotalFemalePermanentUsages
                                         , fpTotalFemalePermanentUsages
                                         , fpCurrentEligibleCoupleCount, fpPrevEligibleCoupleCount
                                         , fpTotalEligibleCoupleCount, fpNewEligibleCoupleCount
                                         , fpTotalOldUsages, fpTotalNewUsages
                                         , fpTotalCurrentUsages, fpTotalPrevUsages
                                         , fpTotalUsages
                                         , fpTotalStartedNone, fpTotalStartedOther
                                         , fpCAR
                                         , mcCurrentNewPregnantCount, mcCurrentOldPregnantCount
                                         , mcCurrentTotalPregnantCount, mcPrevPregnantCount
                                         , mcTotalPregnantCount
                                         , mcANCVisit1Info, mcANCVisit2Info
                                         , mcANCVisit3Info, mcANCVisit4Info
                                         , mcANCVisit1Service, mcANCVisit2Service
                                         , mcANCVisit3Service, mcANCVisit4Service
                                         , mcBirthAtHomeWithTrainedPerson, mcBirthAtHomeWithUntrainedPerson
                                         , mcNormalBirthAtHospitalOrClinic, mcCesareanBirthAtHospitalOrClinic
                                         , mcIsDelivered, mcAMTSL
                                         , mcNoOxytocinAndMisoprostolgiven
                                         , mcMotherPNCVisit1Info, mcMotherPNCVisit2Info
                                         , mcMotherPNCVisit3Info, mcMotherPNCVisit4Info
                                         , mcMotherPNCVisit1Service, mcMotherPNCVisit2Service
                                         , mcMotherPNCVisit3Service, mcMotherPNCVisit4Service
                                         , mcPNCCounselling
                                         , mcChildPNCVisit1Info, mcChildPNCVisit2Info
                                         , mcChildPNCVisit3Info, mcChildPNCVisit4Info
                                         , mcChildPNCVisit1Service, mcChildPNCVisit2Service
                                         , mcChildPNCVisit3Service, mcChildPNCVisit4Service
                                         , mcReferredComplexPregnant, mcReferredTotalComplexityCount
                                         , mcReferredMgSO4Count, mcReferredChildComplexityCount
                                         , mcTTDoseOne, mcTTDoseTwo, mcTTDoseThree
                                         , mcTTDoseFour, mcTTDoseFive
                                         , mcECPReceivedCount, mcMisoprostolReceivedCount
                                         , mcAdvisedIncompatibleCouple, mcReferredIncompatibleCouple
                                         , mcCounsellingOnChangesOfAdolescent
                                         , mcCounsellingBadEffectOnChildMarriageAndTeenPregnancy
                                         , mcCounsellingTeenagersOnTakingIronAndFolicAcid
                                         , mcCounsellingOnInfectionOfDiseases
                                         , mcSatelliteClinicPresence, mcEPISessionPresence
                                         , mcCommunityClinicPresence
                                         , ccIsCleanedInfo, ccIsCleanedService
                                         , ccUsedChlorhexidinInfo, ccUsedChlorhexidinService
                                         , ccFedBreastMilkCount, ccUsedMaskCount
                                         , ccBcgCount, ccOpv1Andpcv1Andpenta1Count
                                         , ccOpv2Andpcv2Andpenta2Count, ccOpv3Andpenta3Count
                                         , ccPcv3Count, ccMrAndopv4Count
                                         , ccMeaslesCount
                                         , ccReferredChildOfDangerousDiseasesInfo
                                         , ccReferredChildOfDangerousDiseasesService
                                         , ccReferredChildOfPneumoniaInfo, ccReferredChildOfPneumoniaService
                                         , ccReferredChildOfDiarrheaInfo, ccReferredChildOfDiarrheaService
                                         , bdTotalLiveBirth, bdtotalChildWithUnderWeight
                                         , bdTotalPrematureChild, bdStillBirthCount
                                         , bdDeathLessThan7Days, bdDeathLessThan28Days
                                         , bdDeathLessThan1Yr, bdTotalDeathLessThan1Yr
                                         , bdDeathLessThan5Yr, bdDeathOfMother
                                         , bdDeathOfOther, bdTotalDeathCount
                                         , wnCounsellingIronForPregWoman, wnCounsellingIronForMother
                                         , wnDistributionIronForPregWoman, wnDistributionIronForMother
                                         , wnCounsellingOnBreastMilkForPregWoman
                                         , wnCounsellingOnBreastMilkForMother
                                         , wnCounsellingOnFeedingMNP
                                         , cnBreastFeedingWithin1Hour, cnBreastFeedingUntill6Month
                                         , cnComplementaryFoodForChild6TO23
                                         , cnComplementaryFoodForChild24to59
                                         , cnReceivedMNP
                                         , cnContractedMAMChildZeroToSix, cnContractedMAMChild6TO23
                                         , cnContractedMAMChild24to59, cnContractedSAMChildZeroToSix
                                         , cnContractedSAMChild6TO23, cnContractedSAMChild24to59
                                         , reporting_division, reporting_district
                                         , reporting_upazilla, reporting_ward
                                         , reporting_union, reporting_unit
                                         , reporting_month, reporting_year
                                         , reporting_provider)
           VALUES (nextval('mis1report_id_seq'), fpOldPillUsage, fpNewPillUsage, fpCurrentTotalPillUsages
                                         , fpPrevTotalPillUsages, fpTotalPillUsages, fpLeftPillAndStartedNone
                                         , fpLeftPillAndStartedOther
                                         , fpOldCondomUsage, fpNewCondomUsage
                                         , fpCurrentTotalCondomUsages, fpPrevTotalCondomUsages
                                         , fpTotalCondomUsages, fpLeftCondomAndStartedNone
                                         , fpLeftCondomAndStartedOther
                                         , fpOldInjectableUsage, fpNewInjectableUsage
                                         , fpCurrentTotalInjectableUsages, fpPrevTotalInjectableUsages
                                         , fpTotalInjectableUsages, fpLeftInjectableAndStartedNone
                                         , fpLeftInjectableAndStartedOther
                                         , fpOldIUDUsage, fpNewIUDUsage
                                         , fpCurrentTotalIUDUsages, fpPrevTotalIUDUsages
                                         , fpTotalIUDUsages, fpLeftIUDAndStartedNone
                                         , fpLeftIUDAndStartedOther
                                         , fpOldImplantUsage, fpNewImplantUsage
                                         , fpCurrentTotalImplantUsages, fpPrevTotalImplantUsages
                                         , fpTotalImplantUsages, fpLeftImplantAndStartedNone
                                         , fpLeftImplantAndStartedOther
                                         , fpOldMalePermanentUsage, fpNewMalePermanentUsage
                                         , fpCurrentTotalMalePermanentUsages, fpPrevTotalMalePermanentUsages
                                         , fpTotalMalePermanentUsages
                                         , fpOldFemalePermanentUsage, fpNewFemalePermanentUsage
                                         , fpCurrentTotalFemalePermanentUsages, fpPrevTotalFemalePermanentUsages
                                         , fpTotalFemalePermanentUsages
                                         , fpCurrentEligibleCoupleCount, fpPrevEligibleCoupleCount
                                         , fpTotalEligibleCoupleCount, fpNewEligibleCoupleCount
                                         , fpTotalOldUsages, fpTotalNewUsages
                                         , fpTotalCurrentUsages, fpTotalPrevUsages
                                         , fpTotalUsages
                                         , fpTotalStartedNone, fpTotalStartedOther
                                         , fpCAR
                                         , mcCurrentNewPregnantCount, mcCurrentOldPregnantCount
                                         , mcCurrentTotalPregnantCount, mcPrevPregnantCount
                                         , mcTotalPregnantCount
                                         , mcANCVisit1Info, mcANCVisit2Info
                                         , mcANCVisit3Info, mcANCVisit4Info
                                         , mcANCVisit1Service, mcANCVisit2Service
                                         , mcANCVisit3Service, mcANCVisit4Service
                                         , mcBirthAtHomeWithTrainedPerson, mcBirthAtHomeWithUntrainedPerson
                                         , mcNormalBirthAtHospitalOrClinic, mcCesareanBirthAtHospitalOrClinic
                                         , mcIsDelivered, mcAMTSL
                                         , mcNoOxytocinAndMisoprostolgiven
                                         , mcMotherPNCVisit1Info, mcMotherPNCVisit2Info
                                         , mcMotherPNCVisit3Info, mcMotherPNCVisit4Info
                                         , mcMotherPNCVisit1Service, mcMotherPNCVisit2Service
                                         , mcMotherPNCVisit3Service, mcMotherPNCVisit4Service
                                         , mcPNCCounselling
                                         , mcChildPNCVisit1Info, mcChildPNCVisit2Info
                                         , mcChildPNCVisit3Info, mcChildPNCVisit4Info
                                         , mcChildPNCVisit1Service, mcChildPNCVisit2Service
                                         , mcChildPNCVisit3Service, mcChildPNCVisit4Service
                                         , mcReferredComplexPregnant, mcReferredTotalComplexityCount
                                         , mcReferredMgSO4Count, mcReferredChildComplexityCount
                                         , mcTTDoseOne, mcTTDoseTwo, mcTTDoseThree
                                         , mcTTDoseFour, mcTTDoseFive
                                         , mcECPReceivedCount, mcMisoprostolReceivedCount
                                         , mcAdvisedIncompatibleCouple, mcReferredIncompatibleCouple
                                         , mcCounsellingOnChangesOfAdolescent
                                         , mcCounsellingBadEffectOnChildMarriageAndTeenPregnancy
                                         , mcCounsellingTeenagersOnTakingIronAndFolicAcid
                                         , mcCounsellingOnInfectionOfDiseases
                                         , mcSatelliteClinicPresence, mcEPISessionPresence
                                         , mcCommunityClinicPresence
                                         , ccIsCleanedInfo, ccIsCleanedService
                                         , ccUsedChlorhexidinInfo, ccUsedChlorhexidinService
                                         , ccFedBreastMilkCount, ccUsedMaskCount
                                         , ccBcgCount, ccOpv1Andpcv1Andpenta1Count
                                         , ccOpv2Andpcv2Andpenta2Count, ccOpv3Andpenta3Count
                                         , ccPcv3Count, ccMrAndopv4Count
                                         , ccMeaslesCount
                                         , ccReferredChildOfDangerousDiseasesInfo
                                         , ccReferredChildOfDangerousDiseasesService
                                         , ccReferredChildOfPneumoniaInfo, ccReferredChildOfPneumoniaService
                                         , ccReferredChildOfDiarrheaInfo, ccReferredChildOfDiarrheaService
                                         , bdTotalLiveBirth, bdtotalChildWithUnderWeight
                                         , bdTotalPrematureChild, bdStillBirthCount
                                         , bdDeathLessThan7Days, bdDeathLessThan28Days
                                         , bdDeathLessThan1Yr, bdTotalDeathLessThan1Yr
                                         , bdDeathLessThan5Yr, bdDeathOfMother
                                         , bdDeathOfOther, bdTotalDeathCount
                                         , wnCounsellingIronForPregWoman, wnCounsellingIronForMother
                                         , wnDistributionIronForPregWoman, wnDistributionIronForMother
                                         , wnCounsellingOnBreastMilkForPregWoman
                                         , wnCounsellingOnBreastMilkForMother
                                         , wnCounsellingOnFeedingMNP
                                         , cnBreastFeedingWithin1Hour, cnBreastFeedingUntill6Month
                                         , cnComplementaryFoodForChild6TO23
                                         , cnComplementaryFoodForChild24to59
                                         , cnReceivedMNP
                                         , cnContractedMAMChildZeroToSix, cnContractedMAMChild6TO23
                                         , cnContractedMAMChild24to59, cnContractedSAMChildZeroToSix
                                         , cnContractedSAMChild6TO23, cnContractedSAMChild24to59
                                         , division, district
                                         , upazilla, ward
                                         , unionname, unit
                                         , currentM, currentY
                                         , provider);

       RAISE NOTICE '%: inserted row: %', now(), currval('mis1report_id_seq');

       ELSE
           RAISE NOTICE '%: record already exist %', now(), recordExists;
       END IF;

       SELECT last_value into current_mis1report_seq_id FROM mis1report_id_seq;
       RETURN current_mis1report_seq_id;
   END;
   $$ LANGUAGE plpgsql;
